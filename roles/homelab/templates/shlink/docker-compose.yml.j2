version: "3.5"
services:
  shlink_webapp:
    image: shlinkio/shlink-web-client:stable
    restart: unless-stopped
    depends_on:
      - shlink_backend
    ports:
      - "5061:80"

  shlink_backend:
    image: shlinkio/shlink:stable
    restart: unless-stopped
    depends_on:
      - shlink_postgres
    ports:
      - "5060:8080"
    environment:
      - "DEFAULT_DOMAIN=shlink.hunterwittenborn.com"
      - "USE_HTTPS=false"
      - "GEOLITE_LICENSE_KEY={{ shlink_geolite_license_key }}"
      - "DB_DRIVER=postgres"
      - "DB_NAME=database"
      - "DB_USER=user"
      - "DB_PASSWORD={{ shlink_postgres_password }}"
      - "DB_HOST=shlink_postgres"
      - "AUTO_RESOLVE_TITLES=true"

  shlink_postgres:
    image: postgres:13
    restart: unless-stopped
    volumes:
      - ./data/postgres:/var/lib/postgresql/data
    environment:
      - "POSTGRES_USER=user"
      - "POSTGRES_PASSWORD={{ shlink_postgres_password }}"
      - "POSTGRES_DB=database"
